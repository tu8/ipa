# دليل إنشاء ملف IPA باستخدام Codemagic

إذا كنت لا تملك جهاز Mac، فإن Codemagic هي أفضل حل لإنشاء ملف IPA لتطبيق Flutter. هذا الدليل يشرح الخطوات بالتفصيل.

## 1. التسجيل في Codemagic

1. انتقل إلى [codemagic.io](https://codemagic.io/) وقم بإنشاء حساب مجاني
2. يمكنك التسجيل باستخدام GitHub أو GitLab أو Bitbucket للربط المباشر مع مستودعاتك

## 2. إعداد المشروع على GitHub

1. أنشئ مستودعًا على GitHub وارفع مشروع لعبة الثعبان:

```bash
# إنشاء مستودع جديد (محلي)
git init

# إضافة الملفات
git add .

# عمل commit
git commit -m "إضافة لعبة الثعبان"

# ربط المستودع المحلي بمستودع GitHub
git remote add origin https://github.com/yourusername/snake_game.git

# رفع المشروع
git push -u origin main
```

## 3. إعداد المشروع في Codemagic

1. في لوحة التحكم الرئيسية، انقر على "Add application"
2. اختر GitHub (أو أي منصة استضافة الشيفرة المصدرية التي تستخدمها)
3. اختر مستودع مشروع لعبة الثعبان
4. حدد Flutter كنوع التطبيق

## 4. تكوين سير العمل (Workflow)

### أساسيات التكوين

1. انتقل إلى تبويب "Workflow settings"
2. تحت "Build for platforms"، حدد iOS فقط
3. اضبط "Flutter version" على إصدار Flutter الذي تستخدمه (مثل `stable`)
4. اضبط "Xcode version" على أحدث إصدار متاح

### إعداد متطلبات الـ iOS

1. تحت قسم "iOS"، اضبط الإعدادات التالية:
   - iOS distribution method: Ad-hoc (للاختبار) أو App Store (للنشر)
   - Bundle identifier: اكتب معرف حزمة فريد (مثل `com.yourusername.snakegame`)

### إعداد الشهادات (لمستخدمي حساب مطور آبل)

إذا كنت تملك حساب مطور آبل، يمكنك تحميل الشهادات:

1. قم بإنشاء ملف الشهادة (.p12) وملف توزيع التطبيق (.mobileprovision) من Apple Developer Portal
2. قم بتحميلهما إلى Codemagic في قسم "Code signing"

### إعداد شهادات تلقائية (دون حساب مطور)

بدون حساب مطور، يمكنك استخدام شهادات مؤقتة:
1. حدد "Automatic code signing" في قسم "iOS code signing"
2. اختر "Development" كنوع الشهادة

## 5. تشغيل البناء

1. انقر على زر "Start build" في أعلى الصفحة
2. اختر فرع Git الذي يحتوي على التطبيق (عادة `main` أو `master`)
3. انقر على "Start new build"

## 6. تنزيل ملف IPA

1. بعد اكتمال عملية البناء بنجاح، انتقل إلى صفحة البناء
2. في قسم "Artifacts"، ستجد ملف IPA جاهزًا للتنزيل
3. انقر على ملف IPA لتنزيله على جهازك

## 7. تثبيت ملف IPA على جهاز iOS

### باستخدام AltStore (للمستخدمين العاديين)

1. قم بتثبيت [AltStore](https://altstore.io/) على جهاز الكمبيوتر الخاص بك
2. قم بتوصيل جهاز iOS بالكمبيوتر
3. افتح AltStore وحدد "Install IPA" من القائمة
4. اختر ملف IPA الذي قمت بتنزيله وانتظر حتى يتم التثبيت

### باستخدام Sideloadly (بديل)

1. قم بتنزيل [Sideloadly](https://sideloadly.io/) وتثبيته
2. قم بتوصيل جهاز iOS بالكمبيوتر
3. اسحب ملف IPA إلى Sideloadly
4. اتبع التعليمات على الشاشة للتثبيت

## 8. نصائح لتجنب المشاكل الشائعة

1. **مشكلة بناء iOS**: إذا فشل البناء، تحقق من:
   - صحة ملف info.plist
   - وجود جميع الأيقونات المطلوبة
   - عدم وجود أخطاء في الكود

2. **مشكلة الشهادات**: الشهادات التلقائية محدودة بـ:
   - 3 أيام فقط قبل انتهاء صلاحيتها
   - تحتاج إلى إعادة تثبيت التطبيق بعد انتهاء الصلاحية

3. **حجم التطبيق**: قم بتحسين حجم التطبيق من خلال:
   - إزالة الموارد غير المستخدمة
   - ضبط `--split-debug-info` لتقليل حجم الرمز

## 9. الخطوة التالية: النشر على App Store

إذا كنت ترغب في نشر التطبيق رسميًا، ستحتاج إلى:
1. حساب مطور آبل ($99 سنويًا)
2. إعداد التطبيق في App Store Connect
3. تكوين Codemagic لتحميل التطبيق مباشرة إلى App Store Connect

## 10. الاستنتاج

Codemagic يوفر حلاً ممتازًا لإنشاء ملفات IPA بدون الحاجة إلى جهاز Mac، خاصة للمشاريع الصغيرة أو الاختبار. لكن للنشر الاحترافي، يُنصح بالاستثمار في حساب مطور آبل وربما جهاز Mac للحصول على تجربة تطوير أكثر سلاسة. 